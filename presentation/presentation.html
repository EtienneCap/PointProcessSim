<!DOCTYPE html>
<html lang="en"><head>
<script src="presentation_files/libs/clipboard/clipboard.min.js"></script>
<script src="presentation_files/libs/quarto-html/tabby.min.js"></script>
<script src="presentation_files/libs/quarto-html/popper.min.js"></script>
<script src="presentation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="presentation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="presentation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="presentation_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="presentation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.433">

  <meta name="author" content="Etienne Caprioli">
  <meta name="dcterms.date" content="2024-06-03">
  <title>Point processes</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="presentation_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="custom.css">
  <link href="presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="presentation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Point processes</h1>
  <p class="subtitle">An overview of the theory and some simulation algorithms</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Etienne Caprioli 
</div>
<div class="quarto-title-author-email">
<a href="mailto:etienne.caprioli23@imperial.ac.uk">etienne.caprioli23@imperial.ac.uk</a>
</div>
        <p class="quarto-title-affiliation">
            Imperial College London
          </p>
    </div>
</div>

  <p class="date">June 3, 2024</p>
</section>
<section class="slide level2">

<!--
before rendering execute in the terminal:
- quarto install extension grantmcdermott/quarto-revealjs-clean
- quarto add gadenbuie/revealjs-text-resizer
-->
</section>
<section id="outline-of-this-presentation" class="slide level2">
<h2>Outline of this presentation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="theory-of-point-processes">Theory of point processes</h3>
<ul>
<li>Definition &amp; interpretation</li>
<li>Basic notation</li>
<li>Main examples of point processes
<ul>
<li>Poisson point processes</li>
<li>Cox point processes</li>
<li>Hawkes point processes</li>
</ul></li>
<li>Some properties of point processes
<ul>
<li>Marked point processes</li>
<li>Simple point processes</li>
<li>Mean measure and intenisty function</li>
<li>Rescaling theorem</li>
<li>Waiting times</li>
<li>Operations on point processes</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<h3 id="simulating-point-processes">Simulating point processes</h3>
<ul>
<li>Poisson point processes
<ul>
<li>Homogeneous Poisson point process (1D &amp; 2D)</li>
<li>Non-homogeneous Poisson point process (1D &amp; 2D)</li>
</ul></li>
<li>Simulating a Hawkes point process
<ul>
<li>Univariate case</li>
<li>Multivariate case</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section>
<section id="theory" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Theory</h1>

</section>
<section id="point-processes-definition" class="slide level2">
<h2>Point processes : definition</h2>
<p>Consider a state space <span class="math inline">\(\mathbb{S}\)</span> (usually <span class="math inline">\(\mathbb{R}\)</span>, <span class="math inline">\([0, +\infty)\)</span>, or <span class="math inline">\(\mathbb{R}^n\)</span>).</p>
<ul>
<li><p>A point process is a random set of points that lies within <span class="math inline">\(\mathbb{S}\)</span>.</p></li>
<li><p>A point process can also be defined as a random counting measure, that counts the number of points in any subset of <span class="math inline">\(\mathbb{S}\)</span>.</p></li>
</ul>
<p>A point <em>pattern</em> is a realisation of a point process.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Examples</strong></p>
</div>
<div class="callout-content">
<p>Phenomenon that can be modeled by point processes: occurrence time of earthquakes and aftershocks (<span class="math inline">\(\mathbb{S} = [0, +\infty)\)</span>]), location of trees in a forest (<span class="math inline">\(\mathbb{S} = \mathbb{R}^2\)</span>), impact locations of lightning in a storm (<span class="math inline">\(\mathbb{S} = \mathbb{R}^2\)</span>)…</p>
</div>
</div>
</div>
<aside class="notes">
<p>Consider a state space <span class="math inline">\(\mathbb{S}\)</span> (usually <span class="math inline">\(\mathbb{R}\)</span>, <span class="math inline">\([0, +\infty)\)</span>, or <span class="math inline">\(\mathbb{R}^n\)</span>).</p>
<p>We know the stochastic processes which is a collection of random variables indexed by a 1D space. The point processes are kind of the extension of stochastic processes to multi-dimensional space. It can be interpreted in 2 ways:</p>
<ul>
<li><p>A point process is a random set of points that lies within <span class="math inline">\(\mathbb{S}\)</span>.</p></li>
<li><p>A point process can also be defined as a random counting measure, that counts the number of points in any subset of <span class="math inline">\(\mathbb{S}\)</span>.</p></li>
</ul>
<p>A point <em>pattern</em> is a realisation of a point process.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="some-basic-notation" class="slide level2">
<h2>Some basic notation</h2>
<p>Since point processes can equivalently be interpreted as random sets or random counting measures, their notation can come from both set theory and measure theory.</p>
<p>Recall for example the (deterministic) counting measure <span class="math inline">\(k(B) = n\)</span>, for any Borel set <span class="math inline">\(B\)</span>.</p>
<p>A point process <span class="math inline">\(N\)</span> can be seen as a random collection of points in <span class="math inline">\(\mathbb{S}\)</span> : <span class="math display">\[
N = \{ x_i\}_{i = 1, \dots, n} \subset \mathbb{S}
\]</span> or as a counting measure that counts the number of random points in any Borel set <span class="math inline">\(B\)</span>:</p>
<p><span class="math display">\[
N(B) = k(B \cap \{x_i\}_{i =1, \dots, n})
\]</span></p>
</section>
<section id="some-basic-notation-1" class="slide level2">
<h2>Some basic notation</h2>
<p>The distribution of the point process depends on the borel set on which we consider it.</p>
<ul>
<li>The distribution of the location of trees depend on the area we are considering (beach, mountain, city,..)</li>
</ul>
<p>Therefore, if we fix a Borel set <span class="math inline">\(B \subset \mathbb{S}\)</span>, then we can define the distribution of <span class="math inline">\(N(B)\)</span>:</p>
<p><span class="math display">\[
N(B) \sim D(B)
\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Interpreation</strong></p>
</div>
<div class="callout-content">
<p>A point process is kind of a random variable that is indexed by sets from the state space <span class="math inline">\(\mathbb{S}\)</span>. For instance, if <span class="math inline">\(\mathbb{S} = [0, +\infty)\)</span>, Then the point process can be entirely described by the random variables <span class="math inline">\(N_{[s, t)}\)</span> or <span class="math inline">\(N_{[0, t)} := N_t\)</span>.</p>
</div>
</div>
</div>
<aside class="notes">
<p>There is a sort of duality in the notation of Point processes. - Th first way to look at it is to consider the point process as a random set of points in <span class="math inline">\(\mathbb{S}\)</span>. - The second way is to consider <span class="math inline">\(N\)</span> as a counting measure, that counts the number of points in any subregion <span class="math inline">\(B\)</span> of <span class="math inline">\(\mathbb{S}\)</span>. Both ntation are equivalent, and sometime one notation is more convenient than the other and sometime the other one is more convenient, depending on the context.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="some-basic-notation-2" class="slide level2">
<h2>Some basic notation</h2>
<p>One can then compute the expectation of these indexed random variable (the expectation will always depend on the Borel set <span class="math inline">\(B\)</span> we consider):</p>
<p><span class="math display">\[
\mathbb{E}(N(B)) = \mathbb{E} \left[ \sum_{x_i \in N} 1_B(x_i) \right]
\]</span> Note that this expectation is also called the <em>mean measure</em> of <span class="math inline">\(N\)</span></p>
<aside class="notes">
<p>The expectation is the expectation of the counting measure (we can’t compute the expectation of a set of points)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="main-examples-of-point-processes" class="slide level2">
<h2>Main examples of point processes</h2>
<h3 id="the-homogeneous-poisson-point-process">The homogeneous Poisson point process</h3>
<p>Formally, a Poisson point process <span class="math inline">\(N\)</span> is a point process that satisfies the following properties:</p>
<ul>
<li>The number of points <span class="math inline">\(N(B)\)</span> in any Borel set <span class="math inline">\(B \subset \mathbb{S}\)</span> is a Poisson-distributed random variable with mean <span class="math inline">\(\Lambda(B) = \lambda |B|\)</span>, where <span class="math inline">\(|B|\)</span> is the size of <span class="math inline">\(B\)</span> in <span class="math inline">\(\mathbb{S}\)</span>.</li>
<li>If <span class="math inline">\(B_1, \dots, B_k\)</span> are disjoint (<span class="math inline">\(B_i \cap B_j = \emptyset, i \neq j\)</span>), then <span class="math inline">\(N(B_1), \dots, N(B_k)\)</span> are independent.</li>
</ul>
<p>We can therefore write:</p>
<p><span class="math display">\[
\forall B \subset \mathbb{S},\quad \forall n \in \mathbb{N}, \quad \mathbb{P}(N(B) = n) = e^{-\lambda |B|}\frac{(\lambda |B|)^n}{n!}
\]</span></p>
<aside class="notes">
<p>The Poisson process is the canonical example of point processes. It plays approximately the same role as the uniform distribution for classical random variables. It is defined as the following:</p>
<ul>
<li>The number of points <span class="math inline">\(N(B)\)</span> in any Borel set <span class="math inline">\(B \subset \mathbb{S}\)</span> is a Poisson-distributed random variable with mean <span class="math inline">\(\Lambda(B) = \lambda |B|\)</span>, where <span class="math inline">\(|B|\)</span> is the size of <span class="math inline">\(B\)</span> in <span class="math inline">\(\mathbb{S}\)</span>. (For instance the surface area in 2D, the volume in 3D, or the length (or duration) in 1D).</li>
<li>If <span class="math inline">\(B_1, \dots, B_k\)</span> are disjoint (<span class="math inline">\(B_i \cap B_j = \emptyset, i \neq j\)</span>), then <span class="math inline">\(N(B_1), \dots, N(B_k)\)</span> are independent.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="main-examples-of-point-processes-1" class="slide level2">
<h2>Main examples of point processes</h2>
<h3 id="example-of-a-1d-homogeneous-poisson-point-process">Example of a 1D homogeneous Poisson point process</h3>

<img data-src="presentation_files/figure-revealjs/Poisson_process_example-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">The “random set of point” is in blue, the counting measure <span class="math inline">\(N_{[0, t)} := N_t\)</span> is in red and the intensity function is the black dashed line.</p></section>
<section id="main-examples-of-point-processes-2" class="slide level2">
<h2>Main examples of point processes</h2>
<h3 id="non-homogeneous-poisson-point-process">Non-homogeneous Poisson point process</h3>
<p>Formally, a Poisson point process <span class="math inline">\(N\)</span> is a point process that satisfies the following properties:</p>
<ul>
<li><p>The number of points <span class="math inline">\(N(B)\)</span> in any Borel set <span class="math inline">\(B \subset \mathbb{S}\)</span> is a Poisson-distributed random variable with mean <span class="math inline">\(\Lambda(B) = \int_B \lambda(x)dx\)</span>, where <span class="math inline">\(\lambda(x) \ge 0\)</span> is a <em>deterministic</em> function.</p></li>
<li><p>If <span class="math inline">\(B_1, \dots, B_k\)</span> are disjoint (<span class="math inline">\(B_i \cap B_j = \emptyset, i \neq j\)</span>), then <span class="math inline">\(N(B_1), \dots, N(B_k)\)</span> are independent.</p></li>
</ul>
<p>We can therefore write:</p>
<p><span class="math display">\[
\forall B \subset \mathbb{S},\quad \forall n \in \mathbb{N}, \quad \mathbb{P}(N(B) = n) = e^{-\Lambda (B)}\frac{\Lambda (B)^n}{n!}
\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Interpreation</strong></p>
</div>
<div class="callout-content">
<p>The function <span class="math inline">\(\lambda(x), x \in \mathbb{S}\)</span> is called the intensity function of the Poisson process. In regions of <span class="math inline">\(\mathbb{S}\)</span> where <span class="math inline">\(\lambda(x)\)</span> is high, the point process is likely to have a lot of points, whereas in regions of <span class="math inline">\(\mathbb{S}\)</span> where <span class="math inline">\(\lambda(x)\)</span> is low, the point process is likely to have fewer points.</p>
</div>
</div>
</div>
<aside class="notes">
<p>The non-homogeneous poisson process is essentially the same as the homogeneous one but we change the mean function, basically we let <span class="math inline">\(\lambda\)</span> vary with <span class="math inline">\(x \in \mathbb{S}\)</span>, but needs to be non-negative. The homogeneous Poisson point process is just a non-homogeneous poisson point process with <span class="math inline">\(\lambda = \text{cst}\)</span>.</p>
<p>Note however that the intensity function <span class="math inline">\(\lambda\)</span> is deterministic.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="main-example-of-point-processes" class="slide level2">
<h2>Main example of point processes</h2>
<h3 id="example-of-a-1-d-non-homogeneous-poisson-point-process">Example of a 1-D Non-homogeneous Poisson point process</h3>

<img data-src="presentation_files/figure-revealjs/non_homogeneous_poisson_process-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">The “random set of point” is in blue, the counting measure <span class="math inline">\(N_{[0, t)} := N_t\)</span> is in red and the intensity function is the black dashed line.</p><aside class="notes">
<p>The only difference here is the non constant so-called intensity function (which I will define properly later on). It basically changes the rates at which the points are coming: the higher the rates, the more points occur.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="main-examples-of-point-processes-3" class="slide level2">
<h2>Main examples of point processes</h2>
<h3 id="the-cox-point-process">The Cox point process</h3>
<p>The Cox point process is a generalisation of the Poisson point process that relaxes the requirement of a deterministic intensity function.</p>
<ul>
<li><p>The number of points <span class="math inline">\(N(B)\)</span> in any Borel set <span class="math inline">\(B \subset \mathbb{S}\)</span> is a Poisson-distributed random variable with mean <span class="math inline">\(\Lambda(B) = \int_B \lambda(x)dx\)</span>, where <span class="math inline">\(\lambda(x) \ge 0\)</span> is a <em>random</em> function (for example <span class="math inline">\(\lambda(x) = e^{-Yx}\)</span> with <span class="math inline">\(Y \sim \text{Exp}(\mu)\)</span>).</p></li>
<li><p>If <span class="math inline">\(B_1, \dots, B_k\)</span> are disjoint (<span class="math inline">\(B_i \cap B_j = \emptyset, i \neq j\)</span>), then <span class="math inline">\(N(B_1), \dots, N(B_k)\)</span> are independent conditionally on <span class="math inline">\(\Lambda(B_1), \dots, \Lambda(B_k)\)</span>.</p></li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important members of the Cox point process family</strong></p>
</div>
<div class="callout-content">
<p>If we consider the Gaussian point processes to be the multidimensional generalisation of Gaussian processes, then we can define the <em>log-Gaussian</em> Cox point process which has the intensity function <span class="math inline">\(\lambda(y) = e^{X(y)}\)</span>, where <span class="math inline">\(X(y)\)</span> is a Gaussian point process.</p>
</div>
</div>
</div>
<aside class="notes">
<p>The Cox process generalises the Poisson process by letting <span class="math inline">\(\lambda\)</span> be random. The mean measure <span class="math inline">\(\Lambda(B)\)</span> is now a random variable that depends on the sub region <span class="math inline">\(B\)</span> where it is evaluated.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="main-examples-of-point-processes-4" class="slide level2">
<h2>Main examples of point processes</h2>
<h3 id="the-hawkes-self-exciting-point-process">The Hawkes (self-exciting) point process</h3>
<p>The Hawkes point process is part of the Cox point process family, it is usually defined on the half real line. The intensity function of the Hawkes process depends on <span class="math inline">\(t \in [0, +\infty)\)</span> but also on the previous points of the process.</p>
<ul>
<li>Let <span class="math inline">\(N\)</span> be a point process. Let <span class="math inline">\(\mathcal{H}_s = \{t_i\}_i\)</span> be the points of the process that are lower than <span class="math inline">\(s\)</span>. Then the conditional intensity of the Hawkes point process is:</li>
</ul>
<p><span class="math display">\[
\lambda(s |\mathcal{H}_s)= \mu(s) + \int_{-\infty}^s h(s-t)dN_t = \mu(s) + \sum_{T_i&lt;s}h(s-T_i)
\]</span> where <span class="math inline">\(N=\{T_i\}_i\)</span> and <span class="math inline">\(h\)</span> is a function called <em>kernel</em>.</p>
<aside class="notes">
<p>Last example of point process: the Hawkes point process, which is part of the Cox process family and has application in finance and environmental science. This process is typically defined on he half real line, and represent the time of occurrence of some event (for instance an earthquake and its aftershocks). It is a self-exciting process because the ocurrence of one event increases the probability of occurrence of another event right after (but this probability decreases with time).</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="main-examples-of-point-processes-5" class="slide level2">
<h2>Main examples of point processes</h2>
<h3 id="the-hawkes-self-exciting-point-process-1">The Hawkes (self-exciting) point process</h3>
<ul>
<li>As usual, conditionally on <span class="math inline">\(\mathcal{H}_t\)</span>, <span class="math inline">\(N\left([t_1, t_2)\right)\)</span> has a Poisson distribution with mean <span class="math inline">\(\Lambda([t_1, t_2)) = \int_{t_1}^{t_2}\lambda(s|\mathcal{H}_s)ds\)</span>.</li>
</ul>
<p>Examples of kernels are:</p>
<ul>
<li>The exponential kernel: <span class="math inline">\(h(s) = \alpha e^{-\beta s}\)</span></li>
<li>The power kernel: <span class="math inline">\(h(s) = \frac{\alpha}{(1+\beta s)^n}\)</span></li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Self-exciting property</strong></p>
</div>
<div class="callout-content">
<p>The Hawkes process is said to be “self-exciting”, meaning that one occurence of the process increases the likelihood of another occurrence happening.</p>
</div>
</div>
</div>
</section>
<section id="main-examples-of-point-processes-6" class="slide level2">
<h2>Main examples of point processes</h2>
<h3 id="example-of-a-1-d-hawkes-point-process-with-the-exponential-kernel">Example of a 1-D Hawkes point process with the exponential kernel</h3>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-incldue="true">
<div class="cell-output-display">
<p><img data-src="presentation_files/figure-revealjs/hawkes_process_simulation-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="presentation_files/figure-revealjs/hawkes_process_sim_2-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</section>
<section id="properties-theorems-on-point-properties" class="slide level2">
<h2>Properties &amp; theorems on point properties</h2>
<h3 id="marked-point-processes">Marked point processes</h3>
<p>A point process only describes the locations of points in some state space <span class="math inline">\(\mathbb{S}\)</span>, to describe what happen at this location, one can define <em>marked</em> point processes.</p>
<p>Let <span class="math inline">\(N = \{x_i\}_i\)</span> be a point process and let <span class="math inline">\(Y_i\)</span> be some random variables indexed by the points of <span class="math inline">\(N\)</span> (not necessarily defined on the same state space as <span class="math inline">\(N\)</span>).</p>
<p><span class="math display">\[
\tilde N = \{(x_i, Y_i), x_i \in N\}
\]</span> Is a marked point process.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Interpretation</strong></p>
</div>
<div class="callout-content">
<p>A marked point process is simply a “labelled” point process, where we added a label to every point generated by the point process. This label can be random or deterministic.</p>
<p>For example, one can consider the previous example with the forest: <span class="math inline">\(N\)</span> represent the location of trees in a forest and <span class="math inline">\(\tilde N\)</span> is the marked process where the points <span class="math inline">\(x_i\)</span> are the location, and <span class="math inline">\(Y_i\)</span> is the (random) species of the tree.</p>
</div>
</div>
</div>
</section>
<section id="properties-theorems-on-point-processes" class="slide level2">
<h2>Properties &amp; theorems on point processes</h2>
<h3 id="simple-point-processes">Simple point processes</h3>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Definition</strong></p>
</div>
<div class="callout-content">
<p>A point process <span class="math inline">\(N\)</span> is said to be <em>simple</em> if all the points of <span class="math inline">\(N\)</span> are distinct with probability one. In other words, a simple point process is a random <em>closed</em> set.</p>
</div>
</div>
</div>
<p>The Poisson point process and the Hawkes point process are examples of simple point processes.</p>
</section>
<section id="properties-and-theorems-on-point-processes" class="slide level2">
<h2>Properties and theorems on point processes</h2>
<h3 id="mean-measure-and-intensity-function">Mean measure and intensity function</h3>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Definition</strong></p>
</div>
<div class="callout-content">
<p>Let <span class="math inline">\(N\)</span> be a point process. The mean measure of <span class="math inline">\(N\)</span>, denoted <span class="math inline">\(\Lambda\)</span> is defined for any Borel set <span class="math inline">\(B \subset \mathbb{S}\)</span> as</p>
<p><span class="math display">\[
\Lambda(B) = \mathbb{E}(N(B))
\]</span> Intuitively, the mean measure is an actual measure that gives the expected number of points in the region <span class="math inline">\(B\)</span> of <span class="math inline">\(\mathbb{S}\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Definition</strong></p>
</div>
<div class="callout-content">
<p>Let <span class="math inline">\(N\)</span> be a point process. We say that the mean measure admits an intensity/density function <span class="math inline">\(\lambda\)</span> if there exist a non-negative function <span class="math inline">\(\lambda\)</span> such that:</p>
<p><span class="math display">\[
\Lambda(B) = \int_B\lambda(x)dx
\]</span> Intuitively, <span class="math inline">\(\lambda(x)\)</span> quantifies how likely it is to find a point in the neighbourhood of <span class="math inline">\(x \in \mathbb{S}\)</span>.</p>
</div>
</div>
</div>
<p>For example, if <span class="math inline">\(N\)</span> is a homogeneous Poisson point process with rate <span class="math inline">\(\lambda\)</span> defined on <span class="math inline">\(\mathbb{S} = [0, +\infty)\)</span>, the mean measure of <span class="math inline">\(N\)</span> is <span class="math inline">\(\Lambda([s, t)) = \lambda(t-s)\)</span> and the intensity function is <span class="math inline">\(\lambda(t) = \lambda\)</span>.</p>
</section>
<section id="properties-and-theorems-on-point-processes-1" class="slide level2">
<h2>Properties and theorems on point processes</h2>
<h3 id="mean-measure-and-intensity-function-1">Mean measure and intensity function</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Remark</strong></p>
</div>
<div class="callout-content">
<p>Note that the intensity function can be defined more formally. For instance here in 1D:</p>
<p><span class="math display">\[
\lambda(t) = \underset{h \to 0^+}{\lim}\frac{\mathbb{P}(N[t, t+h) &gt; 0)}{h}
\]</span></p>
<p>Or under some additional assumtions:</p>
<p><span class="math display">\[
\lambda(t) = \underset{h \to 0^+}{\lim}\frac{\mathbb{E}(N[t, t+h))}{h}
\]</span></p>
</div>
</div>
</div>
</section>
<section id="properties-and-theorems-on-point-processes-2" class="slide level2">
<h2>Properties and theorems on point processes</h2>
<h3 id="rescaling-theorem">Rescaling theorem</h3>
<p>Let us consider a 1D homogeneous Poisson point process <span class="math inline">\(N([0, t)) := N_t\)</span> with rate <span class="math inline">\(\lambda &gt; 0\)</span>. If we apply the time transformation <span class="math inline">\(\tau = t \lambda\)</span> then the resulting point process <span class="math inline">\(\tilde N([0, \tau)) := \tilde N_\tau\)</span> is distributed such that :</p>
<p><span class="math display">\[
\mathbb{P}(\tilde N_\tau = n) = \mathbb{P}(N_{t\lambda} = n) = e^{-\lambda t}\frac{(\lambda t)^n}{n!} = e^{-\tau}\frac{\tau^n}{n!}
\]</span> Which is a homogeneous Poisson process with rate 1 !</p>
<p><span class="bg" style="--col: #D78484">It turns out that this “rescaling” property of point processes is extendable to any simple point process.</span>The right definition for <span class="math inline">\(\tau\)</span> is then <span class="math inline">\(\tau(t) = \Lambda([0, t))\)</span>.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Remark</strong></p>
</div>
<div class="callout-content">
<p>This can be really handy in the context of model validation or assessment of the goodness-of-fit. Indeed, after infering the mean measure parametrically or non-parametrically with some point <em>patterns</em>, one can apply the above scaling transformation to the pattern and test whether this new pattern is a homogeneous point pattern with unit rate.</p>
</div>
</div>
</div>
</section>
<section id="properties-and-theorems-on-point-processes-3" class="slide level2">
<h2>Properties and theorems on point processes</h2>
<h3 id="waiting-times">Waiting times</h3>
<p>In the context of 1D point processes. An important concept is the waiting time.</p>
<p>Let us consider a 1D point process <span class="math inline">\(N = \{T_i\}_i\)</span> defined on <span class="math inline">\(\mathbb{S} = [0, +\infty)\)</span>. The waiting times are defined as the time difference between to events:</p>
<p><span class="math display">\[
\Delta T_i = T_i - T_{i-1}
\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important remark for simulation</strong></p>
</div>
<div class="callout-content">
<p>In some setting, we can derive the distribution of these <span class="math inline">\(\Delta T_i\)</span>. For instance, for a 1D homogeneous Poisson point process, <span class="math inline">\(\Delta T_i \overset{\text{i.i.d.}}{\sim} \text{Exp}(\lambda)\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="properties-and-theorems-on-point-processes-4" class="slide level2">
<h2>Properties and theorems on point processes</h2>
<h3 id="operations-on-point-processes">Operations on point processes</h3>
<p>To create new point processes out of existing one, we can use several operations:</p>
<ul>
<li><strong>Superposition</strong>: for <span class="math inline">\(N_1 = \{x_i\}_i\)</span> and <span class="math inline">\(N_2 = \{y_i\}_i\)</span> two point processes, the superposition <span class="math inline">\(N = N_1 \cup N_2 = \{x_i\}_i \cup \{y_j\}_j\)</span></li>
<li><strong>Thinning</strong>: for a point process <span class="math inline">\(N\)</span>, one can “filter” the point using some rule. For instance: <span class="math inline">\(\forall x_i \in N, \text{ keep } x_i \text{ with probabiliy } p, \text{ otherwise reject } x_i\)</span>.</li>
<li><strong>Clustering</strong>: Let <span class="math inline">\(N\)</span> be a point process (which we will call the parent point process), for any point <span class="math inline">\(x_i\)</span> of this process, create a new daughter point process <span class="math inline">\(\tilde N(x_i)\)</span>. Once all the sub-processes are created, we superpose all the sub-processes together. (Creates a natural clustering in the superposition of all the daughter point patterns).</li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Practical use</strong></p>
</div>
<div class="callout-content">
<p>This operations heavily use the properties and techniques used in set theory to create new sets out of existing ones. These are also very useful when it comes to simulating point processes.</p>
</div>
</div>
</div>
</section></section>
<section>
<section id="simulation" class="title-slide slide level1 center" data-background-color="#40666e">
<h1>Simulation</h1>

</section>
<section id="simulation-of-poisson-point-processes" class="slide level2">
<h2>Simulation of Poisson point processes</h2>
<h3 id="homogeneous-poisson-point-process.">Homogeneous Poisson point process.</h3>
<p>As seen in the definition of the homogeneous Poisson point process, for a region (or simulating window) <span class="math inline">\(W\)</span> of the state space <span class="math inline">\(\mathbb{S}\)</span>, the number of points is <span class="math inline">\(N(W) \sim \text{Poisson}(\lambda |W|)\)</span>. We can easily sample from a Poisson distribution (e.g.&nbsp;<code>rpois</code> in R). But how can we place each points?</p>
<ul>
<li>Since <span class="math inline">\(N\)</span> is a homogeneous poisson process, for any sub-region <span class="math inline">\(B\)</span> of <span class="math inline">\(W\)</span>, the number of points in <span class="math inline">\(B\)</span> must be Poisson distributed with mean <span class="math inline">\(\lambda |B|\)</span>, this can only be achieved if the points are uniformly placed in the simulation window <span class="math inline">\(W\)</span>.</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Simulation algorithm on <span class="math inline">\([0, T)\)</span></strong></p>
</div>
<div class="callout-content">
<p>Example in 1D: let <span class="math inline">\(\lambda &gt; 0\)</span>, the simulation window will be <span class="math inline">\([0, T), T&gt;0\)</span></p>
<ul>
<li>We first generate the number of points in the simulation window: <span class="math inline">\(N \sim \text{Poisson}(\lambda T)\)</span>.</li>
<li>Then we generate N points <span class="math inline">\(\{ T_i \}_{i = 1, \dots, N}\)</span> uniformly distributed along the interval <span class="math inline">\([0, T)\)</span>.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="simulation-of-poisson-point-processes-1" class="slide level2">
<h2>Simulation of Poisson point processes</h2>
<h3 id="homogeneous-poisson-point-process.-1">Homogeneous Poisson point process.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="do">######### Homogeneous Poisson Point process simulation</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="do">## 1-D Simulation (Ex: specific events in time)</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a>T_tot <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>lambda <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>N <span class="ot">=</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda<span class="sc">*</span>T_tot) <span class="co"># Random number of points in the simulation window</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>point_pattern <span class="ot">=</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> T_tot) <span class="co"># Random location along the state space (here [0, + infinity))</span></span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Computing the counting process</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>t <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, T_tot, <span class="at">length.out =</span> <span class="dv">500</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a>N_t <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="fu">length</span>(t))</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="cf">for</span> (point <span class="cf">in</span> point_pattern){</span>
<span id="cb1-14"><a href="#cb1-14"></a>  N_t <span class="ot">=</span> N_t <span class="sc">+</span> <span class="fu">as.numeric</span>(point <span class="sc">&lt;</span> t)</span>
<span id="cb1-15"><a href="#cb1-15"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulation-of-poisson-point-processes-2" class="slide level2">
<h2>Simulation of Poisson point processes</h2>
<h3 id="homogeneous-poisson-point-process.-2">Homogeneous Poisson point process.</h3>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-1-1.png" width="960" class="r-stretch"></section>
<section id="simulation-of-poisson-point-processes-3" class="slide level2">
<h2>Simulation of Poisson point processes</h2>
<h3 id="non-homogeneous-poisson-point-processes.">Non-homogeneous Poisson point processes.</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Remark</strong></p>
</div>
<div class="callout-content">
<p>This method only works if the intensity function is bounded almost surely.</p>
</div>
</div>
</div>
<p>Recalling the definition of the non-homogeneous Poisson process <span class="math inline">\(N\)</span>, we suppose that we have access to an intensity function <span class="math inline">\(\lambda(t)\)</span> (e.g.&nbsp;<span class="math inline">\(\lambda(t) = \sin\left(\frac{2\pi}{T}t\right)^2\)</span>). The intensity function is assumed to be bounded by <span class="math inline">\(\lambda_\text{max}\)</span>.</p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Simulation algorithm on <span class="math inline">\([0, T)\)</span></strong></p>
</div>
<div class="callout-content">
<ul>
<li>We first simulate a homogeneous Poisson point process <span class="math inline">\(N_h\)</span> on <span class="math inline">\([0, T)\)</span> with rate <span class="math inline">\(\lambda^* \ge \lambda_\text{max}\)</span>.</li>
<li>We then apply a thinning operation on this realisation, using <span class="math inline">\(p(t)-\text{thinning}\)</span>:
<ul>
<li>For any point <span class="math inline">\(t_i \in N_h\)</span>, keep this point with probability <span class="math inline">\(p(t_i) = \frac{\lambda(t_i)}{\lambda^*}\)</span>, otherwise discard it.</li>
</ul></li>
</ul>
<p>The resulting points is a realisation of <span class="math inline">\(N\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="simulation-of-poisson-point-processes-4" class="slide level2">
<h2>Simulation of Poisson point processes</h2>
<h3 id="non-homogeneous-poisson-point-processes.-1">Non-homogeneous Poisson point processes.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>intensity <span class="ot">=</span> <span class="cf">function</span>(t, <span class="at">T =</span> T_tot, <span class="at">lam =</span> <span class="dv">1</span>){</span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">return</span>(lam <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">4</span><span class="sc">*</span>pi<span class="sc">*</span>t<span class="sc">/</span>T)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>}</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># Homogeneous process</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>T_tot <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>lambda <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>N <span class="ot">=</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda<span class="sc">*</span>T_tot) <span class="co"># Random number of points</span></span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a>point_pattern <span class="ot">=</span> <span class="fu">runif</span>(N, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> T_tot)</span>
<span id="cb2-11"><a href="#cb2-11"></a></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#Thinning</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>final_point_pattern <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="cf">for</span> (t <span class="cf">in</span> point_pattern){</span>
<span id="cb2-15"><a href="#cb2-15"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fu">intensity</span>(t, T_tot, <span class="at">lam =</span> lambda)<span class="sc">/</span>lambda){</span>
<span id="cb2-16"><a href="#cb2-16"></a>    final_point_pattern <span class="ot">=</span> <span class="fu">c</span>(final_point_pattern, t)</span>
<span id="cb2-17"><a href="#cb2-17"></a>  }</span>
<span id="cb2-18"><a href="#cb2-18"></a>}</span>
<span id="cb2-19"><a href="#cb2-19"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">500</span>)</span>
<span id="cb2-20"><a href="#cb2-20"></a>N_t <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x))</span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="cf">for</span> (point <span class="cf">in</span> final_point_pattern){</span>
<span id="cb2-22"><a href="#cb2-22"></a>  N_t <span class="ot">=</span> N_t <span class="sc">+</span> <span class="fu">as.numeric</span>(point <span class="sc">&lt;</span> x)</span>
<span id="cb2-23"><a href="#cb2-23"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Remark</strong></p>
</div>
<div class="callout-content">
<p>This method is essentially an accept-reject algorithm and therfore has the same inconvenients:</p>
<ul>
<li>A lot of points are generated and then discarded, leading to a waste of computational resources</li>
<li>This solution requires some upper bound <span class="math inline">\(\lambda^*\)</span>, the higher this bound is, the larger the computational waste is.</li>
</ul>
<p>One way to (partly) circumvent this bottleneck is to use an MCMC algorithm</p>
</div>
</div>
</div>
</section>
<section id="simulation-of-poisson-point-processes-5" class="slide level2">
<h2>Simulation of Poisson point processes</h2>
<h3 id="non-homogeneous-poisson-point-processes.-2">Non-homogeneous Poisson point processes.</h3>

<img data-src="presentation_files/figure-revealjs/result_code-1.png" width="960" class="r-stretch"></section>
<section id="simulation-of-hawkes-processes" class="slide level2">
<h2>Simulation of Hawkes processes</h2>
<h3 id="algorithm">Algorithm</h3>
<p>Recall the definition of a Hawkes process <span class="math inline">\(N\)</span>. This process is defined as a Poisson process with a random intensity function that depends on the history <span class="math inline">\(\mathcal{H}_s\)</span> of the process:</p>
<p><span class="math display">\[
\lambda(s| \mathcal{H}_s) = \mu(s) + \sum_{T_i &lt; s} h(s-T_i)
\]</span> with <span class="math inline">\(h\)</span> a kernel function and <span class="math inline">\(\mu\)</span> is a non-negative deterministic function.</p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Simulation algorithm on <span class="math inline">\([0, T)\)</span>:</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Initialise the alogorithm with <span class="math inline">\(s=0\)</span> and <span class="math inline">\(N = \emptyset\)</span>.</li>
<li>While <span class="math inline">\(s&lt;T\)</span>:
<ul>
<li>Compute <span class="math inline">\(\lambda(s) = \mu(s) + \sum_{T_i &lt; s} h(s-T_i)\)</span></li>
<li>Generate a exponential-distributed value <span class="math inline">\(w\)</span> with rate <span class="math inline">\(\lambda(s)\)</span></li>
<li>Set <span class="math inline">\(t^* = s +w\)</span> and compute <span class="math inline">\(\lambda(t^*)\)</span>.</li>
<li>Accept <span class="math inline">\(t^*\)</span> as a new point with probability <span class="math inline">\(\frac{\lambda(t^*)}{\lambda(s)}\)</span>, reject otherwise.</li>
</ul></li>
<li>Ensure all the generated values are below <span class="math inline">\(T\)</span>.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="simulation-of-hawkes-processes-1" class="slide level2">
<h2>Simulation of Hawkes processes</h2>
<h3 id="example">Example</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="do">###### 1D Hawkes process simulation </span></span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>T_tot <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a>exp_kernel_function <span class="ot">=</span> <span class="cf">function</span>(t, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">beta =</span> <span class="dv">1</span>){ <span class="co"># Exponentially decreasing kernel</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">return</span>(alpha <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>beta<span class="sc">*</span>t) <span class="sc">*</span> (t<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb3-7"><a href="#cb3-7"></a>}</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a>base_rate <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>alpha <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>beta <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a>time_points <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb3-14"><a href="#cb3-14"></a>s<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="cf">while</span>(s <span class="sc">&lt;</span> T_tot){</span>
<span id="cb3-16"><a href="#cb3-16"></a>  lambda <span class="ot">=</span> base_rate <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">exp_kernel_function</span>(s<span class="sc">-</span>time_points, <span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta))</span>
<span id="cb3-17"><a href="#cb3-17"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb3-18"><a href="#cb3-18"></a>  w <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(u)<span class="sc">/</span>lambda <span class="co"># Exponentially distributed waiting time with rate lambda</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>  s <span class="ot">=</span> s<span class="sc">+</span>w</span>
<span id="cb3-20"><a href="#cb3-20"></a>  test <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb3-21"><a href="#cb3-21"></a>  <span class="cf">if</span> (test<span class="sc">*</span>lambda <span class="sc">&lt;</span> base_rate <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">exp_kernel_function</span>(s<span class="sc">-</span>time_points, <span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta))){</span>
<span id="cb3-22"><a href="#cb3-22"></a>    time_points <span class="ot">=</span> <span class="fu">c</span>(time_points, s)</span>
<span id="cb3-23"><a href="#cb3-23"></a>  }</span>
<span id="cb3-24"><a href="#cb3-24"></a>}</span>
<span id="cb3-25"><a href="#cb3-25"></a></span>
<span id="cb3-26"><a href="#cb3-26"></a>time_points <span class="ot">=</span> time_points[time_points <span class="sc">&lt;=</span> T_tot]</span>
<span id="cb3-27"><a href="#cb3-27"></a></span>
<span id="cb3-28"><a href="#cb3-28"></a>t <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">500</span>)</span>
<span id="cb3-29"><a href="#cb3-29"></a>lambda_t <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="cf">for</span> (t_i <span class="cf">in</span> t){</span>
<span id="cb3-31"><a href="#cb3-31"></a>  l <span class="ot">=</span> base_rate</span>
<span id="cb3-32"><a href="#cb3-32"></a>  <span class="cf">for</span> (t_event <span class="cf">in</span> time_points){</span>
<span id="cb3-33"><a href="#cb3-33"></a>    l <span class="ot">=</span> l <span class="sc">+</span> <span class="fu">exp_kernel_function</span>(t_i <span class="sc">-</span> t_event, <span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta)</span>
<span id="cb3-34"><a href="#cb3-34"></a>  }</span>
<span id="cb3-35"><a href="#cb3-35"></a>  lambda_t <span class="ot">=</span> <span class="fu">c</span>(lambda_t, l)</span>
<span id="cb3-36"><a href="#cb3-36"></a>}</span>
<span id="cb3-37"><a href="#cb3-37"></a></span>
<span id="cb3-38"><a href="#cb3-38"></a>N_t <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> <span class="fu">length</span>(t))</span>
<span id="cb3-39"><a href="#cb3-39"></a><span class="cf">for</span> (point <span class="cf">in</span> time_points){</span>
<span id="cb3-40"><a href="#cb3-40"></a>  N_t <span class="ot">=</span> N_t <span class="sc">+</span> <span class="fu">as.numeric</span>(point <span class="sc">&lt;</span> t)</span>
<span id="cb3-41"><a href="#cb3-41"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="simulation-of-hawkes-processes-2" class="slide level2">
<h2>Simulation of Hawkes processes</h2>
<h3 id="example-1">Example</h3>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-incldue="true">
<div class="cell-output-display">
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="presentation_files/figure-revealjs/unnamed-chunk-3-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</section>
<section id="mutlivariate-simulation" class="slide level2">
<h2>Mutlivariate simulation</h2>
<h3 id="poisson-processes">Poisson processes</h3>
<p>For Poisson process, one can easily extend the algorithms to higher dimension. Instead of generating uniformly-distributed locations along one axis (1D), we can simply generate several locations along multiple axis.</p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Simulation algorithm on <span class="math inline">\([-a, a]^2\)</span></strong></p>
</div>
<div class="callout-content">
<p>Example in 2D: let <span class="math inline">\(\lambda &gt; 0\)</span>, the simulation window will be <span class="math inline">\([-a, a]^2, a &gt;0\)</span></p>
<ul>
<li>We first generate the number of points in the simulation window: <span class="math inline">\(N_h \sim \text{Poisson}(4 a^2\lambda^*)\)</span>.</li>
<li>Then we generate N points <span class="math inline">\(\{ X_i \}_{i = 1, \dots, N}\)</span> uniformly distributed along the set <span class="math inline">\([-a, a]^2\)</span>.</li>
<li>We then apply a thinning operation on this realisation, using <span class="math inline">\(p(x)-\text{thinning}\)</span>:
<ul>
<li>For any point <span class="math inline">\(x \in N_h\)</span>, keep this point with probability <span class="math inline">\(p(x) = \frac{\lambda(x)}{\lambda^*}\)</span>, otherwise discard it.</li>
</ul></li>
</ul>
<p>The resulting points is a realisation of <span class="math inline">\(N\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="mutlivariate-simulation-1" class="slide level2">
<h2>Mutlivariate simulation</h2>
<h3 id="poisson-processes-1">Poisson processes</h3>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="mutlivariate-simulation-2" class="slide level2">
<h2>Mutlivariate simulation</h2>
<h3 id="poisson-processes-2">Poisson processes</h3>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="mutlivariate-simulation-3" class="slide level2">
<h2>Mutlivariate simulation</h2>
<h3 id="poisson-processes-3">Poisson processes</h3>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch"></section>
<section id="mutlivariate-simulation-4" class="slide level2">
<h2>Mutlivariate simulation</h2>
<h3 id="poisson-processes-4">Poisson processes</h3>

<img data-src="presentation_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="mutlivariate-simulation-5" class="slide level2">
<h2>Mutlivariate simulation</h2>
<h3 id="hawkes-processes">Hawkes processes</h3>
<p>One can consider several interconnected Hawkes point processes: <span class="math inline">\((N_1, N_2, \dots, N_k)\)</span> such that conditionally on their history <span class="math inline">\((\mathcal{H}^1_s, \mathcal{H}^2_s, \dots, \mathcal{H}^k_s)\)</span> at time <span class="math inline">\(s\)</span>, they have the following intensity function:</p>
<p><span class="math display">\[
\lambda^i(s|\mathcal{H}^1_s, \mathcal{H}^2_s, \dots, \mathcal{H}^k_s) = \mu_i(s) + \sum_{j=1}^k \left[\sum_{T_l^j \in N_j, ~~ T_l^j &lt; s} h_{j,i}(s-T_l^j)\right]
\]</span> where <span class="math inline">\(h_{j,i}(.)\)</span> is the kernel function, that parameters the influence of the process <span class="math inline">\(N_j\)</span> on <span class="math inline">\(N_i\)</span>.</p>
<p>For instance, one can opt for <span class="math inline">\(h_{j,i}(s) = \alpha_{j,i}e^{-\beta_{j,i}s}\)</span>, where <span class="math inline">\(\alpha = (\alpha_{j,i})_{j,i}\)</span> and <span class="math inline">\(\beta = (\beta_{j,i})_{j,i}\)</span> are matrices of parameters.</p>
</section>
<section id="mutlivariate-simulation-6" class="slide level2">
<h2>Mutlivariate simulation</h2>
<h3 id="hawkes-processes-1">Hawkes processes</h3>

<img data-src="presentation_files/figure-revealjs/hawkes_2d_simulation-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption">The dashed black line is the conditional intensity function and the blue points are the occurrence times for the three processes.</p></section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<h3 id="code-and-presentation">Code and presentation</h3>
<p><a href="https://github.com/EtienneCap/PointProcessSim">GitHub repository</a></p>
<h3 id="textbooks-and-articles">Textbooks and articles</h3>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-baddeley_spatial_2016" class="csl-entry" role="listitem">
Baddeley, Adrian, Ege Rubak, and Rolf Turner. 2016. <em>Spatial <span>Point</span> <span>Patterns</span> <span>Methodology</span> and <span>Applications</span> with <span>R</span></em>. 1st ed. <a href="https://doi.org/10.1201/b19708">https://doi.org/10.1201/b19708</a>.
</div>
<div id="ref-chen_multivariate_nodate" class="csl-entry" role="listitem">
Chen, Yuanda. n.d.a. <span>“Multivariate <span>Hawkes</span> <span>Processes</span> and <span>Their</span> <span>Simulations</span>.”</span> <a href="https://www.math.fsu.edu/~ychen/research/multiHawkes.pdf">https://www.math.fsu.edu/~ychen/research/multiHawkes.pdf</a>.
</div>
<div id="ref-chen_thinning_nodate" class="csl-entry" role="listitem">
———. n.d.b. <span>“Thinning <span>Algorithms</span> for <span>Simulating</span> <span>Point</span> <span>Processes</span>.”</span> <a href="https://www.math.fsu.edu/~ychen/research/Thinning%20algorithm.pdf">https://www.math.fsu.edu/~ychen/research/Thinning%20algorithm.pdf</a>.
</div>
<div id="ref-chiu_stochastic_2013" class="csl-entry" role="listitem">
Chiu, S., W. Kendall, J. Mecke, and D. Stoyan. 2013. <em>Stochastic <span>Geometry</span> and <span>Its</span> <span>Applications</span></em>. 3rd ed. <a href="https://www.semanticscholar.org/paper/Stochastic-Geometry-and-Its-Applications-Chiu-Stoyan/d9c64e51a90e20cf8bf56799ee3643fc63b33c90">https://www.semanticscholar.org/paper/Stochastic-Geometry-and-Its-Applications-Chiu-Stoyan/d9c64e51a90e20cf8bf56799ee3643fc63b33c90</a>.
</div>
<div id="ref-daley_introduction_2003" class="csl-entry" role="listitem">
Daley, D. J., and D. Vere-Jones. 2003. <em>An <span>Introduction</span> to the <span>Theory</span> of <span>Point</span> <span>Processes</span></em>. Probability and Its <span>Applications</span>. New York: Springer-Verlag. <a href="https://doi.org/10.1007/b97277">https://doi.org/10.1007/b97277</a>.
</div>
<div id="ref-geyer_simulation_1994" class="csl-entry" role="listitem">
Geyer, Charles J., and Jesper Møller. 1994. <span>“Simulation <span>Procedures</span> and <span>Likelihood</span> <span>Inference</span> for <span>Spatial</span> <span>Point</span> <span>Processes</span>.”</span> <em>Scandinavian Journal of Statistics</em> 21 (4): 359–73. <a href="http://www.jstor.org.iclibezp1.cc.ic.ac.uk/stable/4616323">http://www.jstor.org.iclibezp1.cc.ic.ac.uk/stable/4616323</a>.
</div>
<div id="ref-keeler_simulating_2019" class="csl-entry" role="listitem">
Keeler, Paul. 2019. <span>“Simulating an Inhomogeneous <span>Poisson</span> Point Process.”</span> <em>H. Paul Keeler</em>. <a href="https://hpaulkeeler.com/simulating-an-inhomogeneous-poisson-point-process/">https://hpaulkeeler.com/simulating-an-inhomogeneous-poisson-point-process/</a>.
</div>
<div id="ref-moller_perfect_2005" class="csl-entry" role="listitem">
Møller, Jesper, and Jakob G. Rasmussen. 2005. <span>“Perfect Simulation of <span>Hawkes</span> Processes.”</span> <em>Advances in Applied Probability</em> 37 (3): 629–46. <a href="https://doi.org/10.1239/aap/1127483739">https://doi.org/10.1239/aap/1127483739</a>.
</div>
<div id="ref-moller_approximate_2006" class="csl-entry" role="listitem">
———. 2006. <span>“Approximate <span>Simulation</span> of <span>Hawkes</span> <span>Processes</span>.”</span> <em>Methodology and Computing in Applied Probability</em> 8 (1). <a href="https://doi.org/10.1007/s11009-006-7288-z">https://doi.org/10.1007/s11009-006-7288-z</a>.
</div>
<div id="ref-ogata_lewis_1981" class="csl-entry" role="listitem">
Ogata, Y. 1981. <span>“On <span>Lewis</span>’ Simulation Method for Point Processes.”</span> <em>IEEE Transactions on Information Theory</em> 27 (1): 23–31. <a href="https://doi.org/10.1109/TIT.1981.1056305">https://doi.org/10.1109/TIT.1981.1056305</a>.
</div>
<div id="ref-schoenberg_introduction_2011" class="csl-entry" role="listitem">
Schoenberg, Frederic Paik. 2011. <span>“Introduction to <span>Point</span> <span>Processes</span>.”</span> In <em>Wiley <span>Encyclopedia</span> of <span>Operations</span> <span>Research</span> and <span>Management</span> <span>Science</span></em>. John Wiley &amp; Sons, Ltd. <a href="https://doi.org/10.1002/9780470400531.eorms0425">https://doi.org/10.1002/9780470400531.eorms0425</a>.
</div>
</div>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="presentation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/reveal-text-resizer/revealjs-text-resizer.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="presentation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="presentation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealTextResizer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>